<!DOCTYPE html>
<html lang="en" data-theme="dark">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Counter</title>
<style>
*,*::before,*::after{margin:0;padding:0;box-sizing:border-box}
:root{--bg:#0a0a0f;--surface:rgba(255,255,255,.06);--surface-hover:rgba(255,255,255,.1);--text:#f0f0f5;--text-dim:rgba(255,255,255,.5);--accent:#6366f1;--accent-glow:rgba(99,102,241,.4);--border:rgba(255,255,255,.08);--radius:16px;--font:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,sans-serif}
[data-theme="light"]{--bg:#f5f5f7;--surface:rgba(0,0,0,.04);--surface-hover:rgba(0,0,0,.08);--text:#1a1a2e;--text-dim:rgba(0,0,0,.45);--accent:#6366f1;--accent-glow:rgba(99,102,241,.25);--border:rgba(0,0,0,.06)}
html,body{height:100%;font-family:var(--font);background:var(--bg);color:var(--text);transition:background .6s,color .6s;overflow:hidden;user-select:none}
canvas#bg{position:fixed;inset:0;z-index:0;pointer-events:none}
.app{position:relative;z-index:1;display:flex;flex-direction:column;align-items:center;justify-content:center;height:100%;gap:24px;padding:20px}
/* Theme toggle */
.theme-toggle{position:fixed;top:20px;right:20px;z-index:10;background:var(--surface);border:1px solid var(--border);border-radius:50%;width:44px;height:44px;display:flex;align-items:center;justify-content:center;cursor:pointer;font-size:20px;transition:all .3s;backdrop-filter:blur(20px)}
.theme-toggle:hover{background:var(--surface-hover);transform:scale(1.1)}
.sound-toggle{position:fixed;top:20px;right:74px;z-index:10;background:var(--surface);border:1px solid var(--border);border-radius:50%;width:44px;height:44px;display:flex;align-items:center;justify-content:center;cursor:pointer;font-size:20px;transition:all .3s;backdrop-filter:blur(20px)}
.sound-toggle:hover{background:var(--surface-hover);transform:scale(1.1)}
/* Counter display */
.counter-wrap{text-align:center}
.counter-label{font-size:13px;text-transform:uppercase;letter-spacing:4px;color:var(--text-dim);margin-bottom:12px}
.counter{display:flex;align-items:center;justify-content:center;gap:4px;height:120px;overflow:hidden}
.digit-col{position:relative;width:72px;height:120px;overflow:hidden}
.digit-strip{position:absolute;top:0;left:0;width:100%;transition:transform .45s cubic-bezier(.23,1,.32,1)}
.digit-strip span{display:flex;align-items:center;justify-content:center;width:72px;height:120px;font-size:88px;font-weight:700;font-variant-numeric:tabular-nums;color:var(--text)}
.comma{font-size:88px;font-weight:700;color:var(--text-dim);line-height:120px;align-self:flex-end;padding-bottom:8px}
/* Main button */
.main-btn{width:180px;height:180px;border-radius:50%;border:none;background:linear-gradient(135deg,#6366f1,#8b5cf6);color:#fff;font-size:42px;font-weight:700;cursor:pointer;position:relative;transition:transform .15s,box-shadow .15s;box-shadow:0 0 40px var(--accent-glow),0 8px 32px rgba(0,0,0,.3)}
.main-btn:hover{transform:scale(1.05);box-shadow:0 0 60px var(--accent-glow),0 12px 40px rgba(0,0,0,.4)}
.main-btn:active{transform:scale(.95)}
.main-btn .ripple{position:absolute;border-radius:50%;background:rgba(255,255,255,.3);transform:scale(0);animation:ripple .6s linear}
@keyframes ripple{to{transform:scale(4);opacity:0}}
/* Quick buttons */
.quick-btns{display:flex;gap:8px;flex-wrap:wrap;justify-content:center}
.q-btn{padding:8px 16px;border-radius:10px;border:1px solid var(--border);background:var(--surface);color:var(--text);font-size:14px;font-weight:600;cursor:pointer;transition:all .2s;backdrop-filter:blur(20px)}
.q-btn:hover{background:var(--surface-hover);transform:translateY(-2px)}
.q-btn:active{transform:translateY(0)}
.q-btn.danger{border-color:rgba(239,68,68,.3);color:#ef4444}
.q-btn.danger:hover{background:rgba(239,68,68,.1)}
/* Stats */
.stats{display:flex;gap:16px;flex-wrap:wrap;justify-content:center}
.stat{background:var(--surface);border:1px solid var(--border);border-radius:12px;padding:12px 20px;text-align:center;backdrop-filter:blur(20px);min-width:100px}
.stat-val{font-size:22px;font-weight:700}
.stat-label{font-size:11px;text-transform:uppercase;letter-spacing:2px;color:var(--text-dim);margin-top:2px}
/* Share */
.share-btn{padding:10px 24px;border-radius:12px;border:1px solid var(--border);background:var(--surface);color:var(--text);font-size:13px;cursor:pointer;transition:all .2s;backdrop-filter:blur(20px);letter-spacing:1px}
.share-btn:hover{background:var(--surface-hover);transform:translateY(-2px)}
/* Achievement popup */
.achievement{position:fixed;top:50%;left:50%;transform:translate(-50%,-50%) scale(0);background:var(--surface);border:1px solid var(--accent);border-radius:20px;padding:32px 48px;text-align:center;backdrop-filter:blur(30px);z-index:100;transition:transform .4s cubic-bezier(.34,1.56,.64,1),opacity .4s;opacity:0}
.achievement.show{transform:translate(-50%,-50%) scale(1);opacity:1}
.achievement h2{font-size:48px;margin-bottom:8px}
.achievement p{font-size:18px;color:var(--text-dim)}
/* Keyboard hint */
.kb-hint{position:fixed;bottom:20px;left:50%;transform:translateX(-50%);font-size:11px;color:var(--text-dim);letter-spacing:1px;opacity:.5}
/* Confetti canvas */
canvas#confetti{position:fixed;inset:0;z-index:99;pointer-events:none}
@media(max-width:600px){
  .digit-col{width:48px;height:80px}
  .digit-strip span{width:48px;height:80px;font-size:56px}
  .comma{font-size:56px;line-height:80px}
  .counter{height:80px}
  .main-btn{width:140px;height:140px;font-size:32px}
  .stat{min-width:80px;padding:10px 14px}
  .stat-val{font-size:18px}
  .kb-hint{display:none}
}
</style>
</head>
<body>
<canvas id="bg"></canvas>
<canvas id="confetti"></canvas>

<button class="theme-toggle" id="themeBtn">ðŸŒ™</button>
<button class="sound-toggle" id="soundBtn">ðŸ”Š</button>

<div class="app">
  <div class="counter-wrap">
    <div class="counter-label">Count</div>
    <div class="counter" id="counter"></div>
  </div>
  
  <button class="main-btn" id="mainBtn">+1</button>
  
  <div class="quick-btns">
    <button class="q-btn" data-v="-100">âˆ’100</button>
    <button class="q-btn" data-v="-10">âˆ’10</button>
    <button class="q-btn" data-v="-1">âˆ’1</button>
    <button class="q-btn" data-v="10">+10</button>
    <button class="q-btn" data-v="100">+100</button>
    <button class="q-btn danger" data-v="reset">Reset</button>
  </div>
  
  <div class="stats">
    <div class="stat"><div class="stat-val" id="cpm">0</div><div class="stat-label">Clicks/min</div></div>
    <div class="stat"><div class="stat-val" id="session">0:00</div><div class="stat-label">Session</div></div>
    <div class="stat"><div class="stat-val" id="best">0</div><div class="stat-label">Best</div></div>
    <div class="stat"><div class="stat-val" id="alltime">0</div><div class="stat-label">All-time</div></div>
  </div>
  
  <button class="share-btn" id="shareBtn">ðŸ“‹ Share Count</button>
</div>

<div class="achievement" id="achievement"><h2 id="achEmoji">ðŸŽ‰</h2><p id="achText"></p></div>
<div class="kb-hint">Space +1 Â· Backspace âˆ’1 Â· R Reset</div>

<script>
// State
let count = parseInt(localStorage.getItem('count')||'0');
let allTime = parseInt(localStorage.getItem('alltime')||'0');
let best = parseInt(localStorage.getItem('best')||'0');
let soundOn = localStorage.getItem('sound')!=='off';
let theme = localStorage.getItem('theme')||'dark';
let clicks=[], sessionStart=Date.now();

// Audio context
let audioCtx;
function getAudio(){if(!audioCtx)audioCtx=new(window.AudioContext||window.webkitAudioContext)();return audioCtx}
function playClick(n){
  if(!soundOn)return;
  const ctx=getAudio(),o=ctx.createOscillator(),g=ctx.createGain();
  o.connect(g);g.connect(ctx.destination);
  o.frequency.value=400+Math.min(n,1000)*2;
  o.type='sine';g.gain.value=.08;
  o.start();g.gain.exponentialRampToValueAtTime(.001,ctx.currentTime+.12);
  o.stop(ctx.currentTime+.12)
}
function playMilestone(){
  if(!soundOn)return;
  const ctx=getAudio();
  [523,659,784,1047].forEach((f,i)=>{
    const o=ctx.createOscillator(),g=ctx.createGain();
    o.connect(g);g.connect(ctx.destination);
    o.frequency.value=f;o.type='sine';g.gain.value=.1;
    o.start(ctx.currentTime+i*.1);
    g.gain.exponentialRampToValueAtTime(.001,ctx.currentTime+i*.1+.3);
    o.stop(ctx.currentTime+i*.1+.3)
  })
}

// Theme
document.documentElement.dataset.theme=theme;
document.getElementById('themeBtn').textContent=theme==='dark'?'ðŸŒ™':'â˜€ï¸';
document.getElementById('themeBtn').onclick=()=>{
  theme=theme==='dark'?'light':'dark';
  document.documentElement.dataset.theme=theme;
  document.getElementById('themeBtn').textContent=theme==='dark'?'ðŸŒ™':'â˜€ï¸';
  localStorage.setItem('theme',theme)
};

// Sound
document.getElementById('soundBtn').textContent=soundOn?'ðŸ”Š':'ðŸ”‡';
document.getElementById('soundBtn').onclick=()=>{
  soundOn=!soundOn;
  document.getElementById('soundBtn').textContent=soundOn?'ðŸ”Š':'ðŸ”‡';
  localStorage.setItem('sound',soundOn?'on':'off')
};

// Counter rendering
const counterEl=document.getElementById('counter');
function renderCounter(val){
  const s=Math.abs(val).toString();
  const neg=val<0;
  const digits=(neg?'-':'')+s;
  // Add commas
  let formatted=[];
  const numPart=s.split('');
  for(let i=0;i<numPart.length;i++){
    if(i>0&&(numPart.length-i)%3===0)formatted.push(',');
    formatted.push(numPart[i])
  }
  if(neg)formatted.unshift('-');
  
  // Build digit columns
  let html='';
  formatted.forEach((ch,i)=>{
    if(ch===','||ch==='-'){
      html+=`<span class="comma">${ch}</span>`;
    } else {
      const d=parseInt(ch);
      const offset=-d*120;
      html+=`<div class="digit-col"><div class="digit-strip" style="transform:translateY(${offset}px)">`;
      for(let n=0;n<=9;n++)html+=`<span>${n}</span>`;
      html+=`</div></div>`;
    }
  });
  counterEl.innerHTML=html;
}

// Milestones
const milestones=[10,50,100,250,500,1000,2500,5000,10000,25000,50000,100000];
const achEl=document.getElementById('achievement');
function checkMilestone(val){
  if(milestones.includes(val)){
    const emojis=['ðŸŽ¯','â­','ðŸ”¥','ðŸ’Ž','ðŸš€','ðŸ‘‘','ðŸŒŸ','ðŸ’«','ðŸ†','ðŸŽ†','âœ¨','ðŸŒˆ'];
    const idx=milestones.indexOf(val);
    document.getElementById('achEmoji').textContent=emojis[idx]||'ðŸŽ‰';
    document.getElementById('achText').textContent=val.toLocaleString()+'!';
    achEl.classList.add('show');
    playMilestone();
    fireConfetti();
    setTimeout(()=>achEl.classList.remove('show'),2000)
  }
}

// Update count
function updateCount(delta){
  if(delta==='reset'){count=0}
  else{count+=delta;allTime+=Math.abs(delta)}
  if(count>best){best=count;localStorage.setItem('best',best)}
  localStorage.setItem('count',count);
  localStorage.setItem('alltime',allTime);
  renderCounter(count);
  playClick(Math.abs(count));
  clicks.push(Date.now());
  if(delta!=='reset')checkMilestone(count);
  updateStats()
}

// Main button with hold support
const mainBtn=document.getElementById('mainBtn');

function handlePress(e){
  // Get coordinates from either touch or mouse
  const x=e.touches?e.touches[0].clientX:e.clientX;
  const y=e.touches?e.touches[0].clientY:e.clientY;
  
  // Ripple
  const r=document.createElement('span');
  r.classList.add('ripple');
  const rect=mainBtn.getBoundingClientRect();
  r.style.left=(x-rect.left)+'px';
  r.style.top=(y-rect.top)+'px';
  mainBtn.appendChild(r);
  setTimeout(()=>r.remove(),600);
  
  // Particles
  spawnParticles(x,y);
  
  // Update count
  updateCount(1);
}

// Click/tap
mainBtn.onclick=handlePress;

// Hold to increment
let holdTimer=null;
const holdDelay=200;
function startHold(e){
  e.preventDefault();
  handlePress(e);
  holdTimer=setInterval(()=>updateCount(1),holdDelay)
}
function stopHold(){
  if(holdTimer){clearInterval(holdTimer);holdTimer=null}
}

// Touch events for iOS
mainBtn.ontouchstart=startHold;
mainBtn.ontouchend=stopHold;
mainBtn.ontouchcancel=stopHold;

// Mouse events for desktop
mainBtn.onmousedown=startHold;
mainBtn.onmouseup=stopHold;
mainBtn.onmouseleave=stopHold;

// Quick buttons
document.querySelectorAll('.q-btn').forEach(b=>{
  b.onclick=()=>{
    const v=b.dataset.v;
    updateCount(v==='reset'?'reset':parseInt(v))
  }
});

// Keyboard (with hold support)
let keyHoldTimer=null;
document.addEventListener('keydown',e=>{
  if(e.repeat)return;
  if(e.code==='Space'){e.preventDefault();updateCount(1);keyHoldTimer=setInterval(()=>updateCount(1),holdDelay)}
  else if(e.code==='Backspace'){e.preventDefault();updateCount(-1);keyHoldTimer=setInterval(()=>updateCount(-1),holdDelay)}
  else if(e.code==='KeyR')updateCount('reset')
});
document.addEventListener('keyup',e=>{if(keyHoldTimer){clearInterval(keyHoldTimer);keyHoldTimer=null}});
document.querySelectorAll('.q-btn').forEach(b=>{
  b.onclick=()=>{
    const v=b.dataset.v;
    updateCount(v==='reset'?'reset':parseInt(v))
  }
});

// Share
document.getElementById('shareBtn').onclick=()=>{
  navigator.clipboard.writeText(`My count: ${count.toLocaleString()} ðŸ”¢`).then(()=>{
    document.getElementById('shareBtn').textContent='âœ… Copied!';
    setTimeout(()=>document.getElementById('shareBtn').textContent='ðŸ“‹ Share Count',1500)
  })
};

// Stats
function updateStats(){
  const now=Date.now();
  clicks=clicks.filter(t=>now-t<60000);
  document.getElementById('cpm').textContent=clicks.length;
  document.getElementById('best').textContent=best.toLocaleString();
  document.getElementById('alltime').textContent=allTime.toLocaleString();
}
setInterval(()=>{
  const s=Math.floor((Date.now()-sessionStart)/1000);
  const m=Math.floor(s/60);
  document.getElementById('session').textContent=m+':'+(s%60).toString().padStart(2,'0');
  updateStats()
},1000);

// Particles
const particles=[];
function spawnParticles(x,y){
  for(let i=0;i<12;i++){
    particles.push({
      x,y,
      vx:(Math.random()-.5)*8,
      vy:(Math.random()-.5)*8-4,
      life:1,
      size:Math.random()*4+2,
      color:`hsl(${240+Math.random()*60},80%,65%)`
    })
  }
}

// Background canvas
const bgCanvas=document.getElementById('bg');
const bgCtx=bgCanvas.getContext('2d');
const floaters=[];
function resizeBg(){bgCanvas.width=innerWidth;bgCanvas.height=innerHeight}
resizeBg();
window.addEventListener('resize',resizeBg);
for(let i=0;i<40;i++){
  floaters.push({
    x:Math.random()*innerWidth,
    y:Math.random()*innerHeight,
    r:Math.random()*2+.5,
    vx:(Math.random()-.5)*.3,
    vy:(Math.random()-.5)*.3,
    alpha:Math.random()*.3+.1
  })
}
let hue=240;
function drawBg(){
  hue=(hue+.02)%360;
  const isDark=theme==='dark';
  bgCtx.fillStyle=isDark?'#0a0a0f':'#f5f5f7';
  bgCtx.fillRect(0,0,bgCanvas.width,bgCanvas.height);
  
  // Gradient orbs
  const g1=bgCtx.createRadialGradient(bgCanvas.width*.3,bgCanvas.height*.4,0,bgCanvas.width*.3,bgCanvas.height*.4,bgCanvas.width*.4);
  g1.addColorStop(0,`hsla(${hue},60%,${isDark?15:85}%,.3)`);
  g1.addColorStop(1,'transparent');
  bgCtx.fillStyle=g1;bgCtx.fillRect(0,0,bgCanvas.width,bgCanvas.height);
  
  const g2=bgCtx.createRadialGradient(bgCanvas.width*.7,bgCanvas.height*.6,0,bgCanvas.width*.7,bgCanvas.height*.6,bgCanvas.width*.35);
  g2.addColorStop(0,`hsla(${hue+60},60%,${isDark?15:85}%,.25)`);
  g2.addColorStop(1,'transparent');
  bgCtx.fillStyle=g2;bgCtx.fillRect(0,0,bgCanvas.width,bgCanvas.height);
  
  // Floaters
  floaters.forEach(f=>{
    f.x+=f.vx;f.y+=f.vy;
    if(f.x<0)f.x=bgCanvas.width;if(f.x>bgCanvas.width)f.x=0;
    if(f.y<0)f.y=bgCanvas.height;if(f.y>bgCanvas.height)f.y=0;
    bgCtx.beginPath();bgCtx.arc(f.x,f.y,f.r,0,Math.PI*2);
    bgCtx.fillStyle=`hsla(${hue},50%,${isDark?70:40}%,${f.alpha})`;
    bgCtx.fill()
  });
  
  // Click particles
  for(let i=particles.length-1;i>=0;i--){
    const p=particles[i];
    p.x+=p.vx;p.y+=p.vy;p.vy+=.15;p.life-=.02;
    if(p.life<=0){particles.splice(i,1);continue}
    bgCtx.globalAlpha=p.life;
    bgCtx.beginPath();bgCtx.arc(p.x,p.y,p.size*p.life,0,Math.PI*2);
    bgCtx.fillStyle=p.color;bgCtx.fill();
    bgCtx.globalAlpha=1
  }
  requestAnimationFrame(drawBg)
}
drawBg();

// Confetti
const confCanvas=document.getElementById('confetti');
const confCtx=confCanvas.getContext('2d');
function resizeConf(){confCanvas.width=innerWidth;confCanvas.height=innerHeight}
resizeConf();window.addEventListener('resize',resizeConf);
let confetti=[];
function fireConfetti(){
  for(let i=0;i<80;i++){
    confetti.push({
      x:innerWidth/2,y:innerHeight/2,
      vx:(Math.random()-.5)*16,
      vy:(Math.random()-.5)*16-8,
      w:Math.random()*8+4,h:Math.random()*6+2,
      color:`hsl(${Math.random()*360},80%,60%)`,
      rot:Math.random()*360,
      rotV:(Math.random()-.5)*15,
      life:1
    })
  }
}
function drawConfetti(){
  confCtx.clearRect(0,0,confCanvas.width,confCanvas.height);
  for(let i=confetti.length-1;i>=0;i--){
    const c=confetti[i];
    c.x+=c.vx;c.y+=c.vy;c.vy+=.3;c.rot+=c.rotV;c.life-=.008;
    c.vx*=.99;
    if(c.life<=0){confetti.splice(i,1);continue}
    confCtx.save();confCtx.translate(c.x,c.y);confCtx.rotate(c.rot*Math.PI/180);
    confCtx.globalAlpha=c.life;confCtx.fillStyle=c.color;
    confCtx.fillRect(-c.w/2,-c.h/2,c.w,c.h);
    confCtx.restore()
  }
  requestAnimationFrame(drawConfetti)
}
drawConfetti();

// Init
renderCounter(count);
updateStats();
</script>
</body>
</html>
